import{u as h}from"./chunk-A28ZiPww.js";import{u as S}from"./chunk-LsewXPB6.js";import{h2 as T,U,lE as b,g_ as g,g$ as k,lG as v,hc as I}from"./chunk-xdbuWCSg.js";import{s as L}from"./chunk-B3AFDltd.js";import{c as M}from"./chunk-gtyL-bMM.js";const w={extras:{type:Array,default:()=>[]}},A={click:e=>e},C=T({name:"VaWmsLayerOnClick",emits:A,props:w,setup(e,{emit:c}){const t=h(),n=S(),i=t[L],l=M(i),a=new l("click",async m=>{const{event:u}=m,d=n.sublayers.filter(s=>s.visible&&s.queryable&&s.name).map(({name:s})=>s);d.push(...e.extras);const r=d.join(),{xmin:f,ymin:y,xmax:E,ymax:$,spatialReference:{wkid:x}}=t.extent,_=`${f},${y},${E},${$}`,R=`EPSG:${x}`;let p;r&&(p=await U(n.featureInfoUrl,{query:{SERVICE:"WMS",LAYERS:r,QUERY_LAYERS:r,REQUEST:"GetFeatureInfo",INFO_FORMAT:"application/json",FEATURE_COUNT:5,BBOX:_,CRS:R,WIDTH:t.width,HEIGHT:t.height,I:Math.round(u.x),J:Math.round(u.y)}})),c("click",{...m,requestResponse:p})});return a.add(),b(()=>{a.remove()}),g(()=>{a.remove()}),k(()=>{a.add()}),{}}});function H(e,c,t,n,i,l){return I(e.$slots,"default")}const o=v(C,[["render",H]]);o.install=e=>{e.component(o.name,o)};export{o as V};
