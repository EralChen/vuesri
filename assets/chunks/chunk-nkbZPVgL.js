import{gm as E,kU as V,mM as P,gs as k,l4 as u,ci as O,gt as A,gy as g,nJ as F,s3 as _,gn as i,l1 as S,l6 as j,gF as B,gv as w,gG as M,gL as C,gA as $,l9 as G,nH as L,gC as N,gN as T}from"./chunk-ERvgPDZ8.js";import{u as H}from"./chunk-OMr8FG4E.js";import"./chunk-PqXAlAeV.js";import{u as I}from"./chunk-kWGeHa0b.js";import{u as U}from"./chunk-FNt4GW2h.js";function J(){const e=E("vaSketch");if(!e)throw new Error("The component which use useSketch() must be in a Sketch component");return e}const y={modelValue:{type:[Array,Object],default:()=>[]},multiple:{type:Boolean,default:!0}},q=V(y),p={"update:modelValue":e=>e,complete:e=>e,update:e=>!0,create:e=>!0},z=P(p),D={...y,defaultOptions:{type:Object,default:()=>({})},availableCreatureTools:{type:Array,default:void 0},position:{type:String,default:"top-right"},orphan:{type:Boolean,default:!1},modelValueInitFrom:{type:String,default:"modelValue"},viewModelPointSymbol:{type:Object},viewModelPolygonSymbol:{type:Object},viewModelPolylineSymbol:{type:Object},viewModelActiveFillSymbol:{type:Object},visibleElements:{type:Object,default:void 0}},K=q,Q={load:e=>e,...p},R=z,W=k({props:y,emits:p,setup(e,{emit:l}){const s=J(),n=I(),a=s.on("create",o=>{l("create",o),o.state==="start"?e.multiple||n.removeAll():o.state==="complete"&&(!e.multiple&&n.graphics.length>1&&o.graphic.geometry.type==="point"&&n.remove(n.graphics.getItemAt(0)),l("update:modelValue",[...n.graphics]),l("complete",o))});u(()=>{a.remove()});const r=s.on("update",o=>{l("update",o),o.state==="complete"&&(l("update:modelValue",[...n.graphics]),l("complete",o))});return u(()=>{r.remove()}),()=>null}}),X=k({name:"VaSketch",components:{Events:W},emits:Q,props:D,setup(e,{emit:l}){const s=H(),n=s.map;let a=E("vaGraphicsLayer",null);a||(a=new O,n.add(a));const r=K(e),o=R(l);function v(t){a.removeAll(),a.addMany(t)}A(()=>e.modelValue,(t,b)=>{let d=!1;if(t.length===b.length){for(let c=0;c<t.length;c++)if(t[c]!==b[c]){d=!0;break}}else d=!0;d&&v([...t])}),e.modelValueInitFrom==="layerGraphics"?l("update:modelValue",a.graphics):v(e.modelValue);const f=g(),h=g(!1);return F(()=>{const t=new _({container:f.value,view:s,layer:a,creationMode:"single",...e.defaultOptions});i(()=>{e.visibleElements&&(t.visibleElements=e.visibleElements)}),i(()=>{e.viewModelPointSymbol&&(t.viewModel.pointSymbol=e.viewModelPointSymbol)}),i(()=>{e.viewModelPolylineSymbol&&(t.viewModel.polylineSymbol=e.viewModelPolylineSymbol)}),i(()=>{e.viewModelPolygonSymbol&&(t.viewModel.polygonSymbol=e.viewModelPolygonSymbol)}),i(()=>{e.viewModelActiveFillSymbol&&(t.viewModel.activeFillSymbol=e.viewModelActiveFillSymbol)}),i(()=>{e.availableCreatureTools&&(t.availableCreateTools=e.availableCreatureTools)}),u(()=>{t.destroy()}),U(s.ui,t,e),S("vaGraphicsLayer",a),S("vaSketch",t),h.value=!0,l("load",{sketch:t,view:s})}),{eventsBindProps:r,eventsOnEmits:o,sketchNode:f,ready:h}}}),Y={ref:"sketchNode"};function Z(e,l,s,n,a,r){const o=B("Events");return w(),M("div",Y,[e.ready?(w(),M(C,{key:0},[$(o,G(e.eventsBindProps,L(e.eventsOnEmits)),null,16),N(e.$slots,"default")],64)):T("",!0)],512)}const m=j(X,[["render",Z]]);m.install=e=>{e.component(m.name,m)};export{m as V};
