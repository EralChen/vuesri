import{u as h}from"./chunk-5yhB8Y-n.js";import{u as S}from"./chunk-miGwR9an.js";import{h2 as T,U,lF as b,g_ as g,g$ as k,lH as v,hc as H}from"./chunk-gZYsZ36N.js";import{s as I}from"./chunk-B3AFDltd.js";import{c as L}from"./chunk-jDrT5IC_.js";const M={extras:{type:Array,default:()=>[]}},w={click:e=>e},A=T({name:"VaWmsLayerOnClick",emits:w,props:M,setup(e,{emit:c}){const t=h(),n=S(),i=t[I],l=L(i),a=new l("click",async m=>{const{event:u}=m,d=n.sublayers.filter(s=>s.visible&&s.queryable&&s.name).map(({name:s})=>s);d.push(...e.extras);const r=d.join(),{xmin:f,ymin:y,xmax:$,ymax:x,spatialReference:{wkid:E}}=t.extent,_=`${f},${y},${$},${x}`,R=`EPSG:${E}`;let p;r&&(p=await U(n.featureInfoUrl,{query:{SERVICE:"WMS",LAYERS:r,QUERY_LAYERS:r,REQUEST:"GetFeatureInfo",INFO_FORMAT:"application/json",FEATURE_COUNT:5,BBOX:_,CRS:R,WIDTH:t.width,HEIGHT:t.height,I:Math.round(u.x),J:Math.round(u.y)}})),c("click",{...m,requestResponse:p})});return a.add(),b(()=>{a.remove()}),g(()=>{a.remove()}),k(()=>{a.add()}),{}}});function C(e,c,t,n,i,l){return H(e.$slots,"default")}const o=v(A,[["render",C]]);o.install=e=>{e.component(o.name,o)};export{o as V};
