import{u as g}from"./chunk-OMr8FG4E.js";import{u as S}from"./chunk--etz0pIO.js";import{gs as T,z as b,l4 as h,gq as k,gp as v,l6 as C,gC as I}from"./chunk-ERvgPDZ8.js";import{c as L}from"./chunk-3E9jM2aR.js";import{c as M}from"./chunk-TReN2ucZ.js";const w={extras:{type:Array,default:()=>[]}},A={click:e=>e},H=T({name:"VaWmsLayerOnClick",emits:A,props:w,setup(e,{emit:c}){const t=g(),n=S(),i=t[L],l=M(i),a=new l("click",async m=>{const{event:u}=m,p=n.sublayers.filter(s=>s.visible&&s.queryable&&s.name).map(({name:s})=>s);p.push(...e.extras);const r=p.join(),{xmin:f,ymin:y,xmax:x,ymax:E,spatialReference:{wkid:R}}=t.extent,_=`${f},${y},${x},${E}`,$=`EPSG:${R}`;let d;r&&(d=await b(n.featureInfoUrl,{query:{SERVICE:"WMS",LAYERS:r,QUERY_LAYERS:r,REQUEST:"GetFeatureInfo",INFO_FORMAT:"application/json",FEATURE_COUNT:5,BBOX:_,CRS:$,WIDTH:t.width,HEIGHT:t.height,I:Math.round(u.x),J:Math.round(u.y)}})),c("click",{...m,requestResponse:d})});return a.add(),h(()=>{a.remove()}),k(()=>{a.remove()}),v(()=>{a.add()}),{}}});function O(e,c,t,n,i,l){return I(e.$slots,"default")}const o=C(H,[["render",O]]);o.install=e=>{e.component(o.name,o)};export{o as V};
