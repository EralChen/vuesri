import{fB as c,dk as p,V as y,e0 as m,dZ as f,ak as g,z as w,fJ as V,$ as v,a2 as C}from"./chunk-xdbuWCSg.js";import"./chunk-t4TbIqUg.js";const s=Symbol();let l=class extends c(p){constructor(){super(...arguments),this.layerViews=new y,this._debouncedUpdate=m(async()=>{const{layer:e,parent:{footprintLayerView:a}}=this;let i=[];if(a){const r=this._createQuery(),{features:d}=await a.queryFeatures(r);this.suspended||(i=d.map(n=>e.acquireLayer(n)))}this.removeHandles(s),this.addHandles(i,s)})}attach(){this.addAttachHandles([this._updatingHandles.addOnCollectionChange(()=>this.layerViews,()=>this._updateStageChildren(),{initial:!0}),f(()=>this.parent.footprintLayerView?.dataUpdating===!1,()=>this._updateLayers()),g(()=>[this.layer.maximumVisibleSublayers,this.suspended,this.parent.footprintLayerView?.filter],()=>this._updateLayers())])}detach(){this.container.removeAllChildren(),this.removeHandles(s)}update(e){}moveStart(){}viewChange(){}moveEnd(){}isUpdating(){return this.layerViews.some(e=>e.updating)}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((e,a)=>this.container.addChildAt(e.container,a))}_updateLayers(){this.suspended?this.removeHandles(s):this._updatingHandles.addPromise(this._debouncedUpdate().catch(e=>{w.getLogger(this).error(e)}))}_createQuery(){const{parent:{footprintLayerView:e},layer:{maximumVisibleSublayers:a,parent:{itemTypeField:i,itemSourceField:r,objectIdField:d,orderBy:n}}}=this,u=`${i} <> 'Scene Service'`,t=e.createQuery();t.returnGeometry=!1,t.num=a,t.outFields=[d,r],t.where=V(t.where,u);const o=n?.find(h=>h.field&&!h.valueExpression);return o?.field&&(t.orderByFields=[`${o.field} ${o.order==="descending"?"DESC":"ASC"}`]),t}};l=v([C("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],l);const $=l;export{$ as default};
