import{u as g}from"./chunk-dfbnxT3d.js";import{u as S}from"./chunk-ddV5Ho3e.js";import{c as T}from"./chunk-3E9jM2aR.js";import{gp as b,y as h,l0 as k,gn as v,gm as I,l2 as L,gz as M}from"./chunk-m3jlTyOz.js";import{c as w}from"./chunk-UIYUfr_z.js";const A={extras:{type:Array,default:()=>[]}},C={click:e=>e},H=b({name:"VaWmsLayerOnClick",emits:C,props:A,setup(e,{emit:c}){const t=g(),n=S(),i=t[T],l=w(i),a=new l("click",async m=>{const{event:u}=m,p=n.sublayers.filter(s=>s.visible&&s.queryable&&s.name).map(({name:s})=>s);p.push(...e.extras);const r=p.join(),{xmin:f,ymin:y,xmax:x,ymax:E,spatialReference:{wkid:R}}=t.extent,_=`${f},${y},${x},${E}`,$=`EPSG:${R}`;let d;r&&(d=await h(n.featureInfoUrl,{query:{SERVICE:"WMS",LAYERS:r,QUERY_LAYERS:r,REQUEST:"GetFeatureInfo",INFO_FORMAT:"application/json",FEATURE_COUNT:5,BBOX:_,CRS:$,WIDTH:t.width,HEIGHT:t.height,I:Math.round(u.x),J:Math.round(u.y)}})),c("click",{...m,requestResponse:d})});return a.add(),k(()=>{a.remove()}),v(()=>{a.remove()}),I(()=>{a.add()}),{}}});function O(e,c,t,n,i,l){return M(e.$slots,"default")}const o=L(H,[["render",O]]);o.install=e=>{e.component(o.name,o)};export{o as V};
