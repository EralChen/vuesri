import{gj as k,kS as V,mH as P,gp as E,l0 as u,cf as O,gt as _,gv as g,nB as j,rZ as A,gk as i,kZ as S,l2 as B,gC as C,gq as w,gD as M,gI as F,gy as $,l5 as G,nC as T,gz as H,gK as I}from"./chunk-m3jlTyOz.js";import{u as L}from"./chunk-dfbnxT3d.js";import"./chunk-Q_TLMJUJ.js";import{u as N}from"./chunk-yFbf1y_K.js";import{u as U}from"./chunk-gulYoy5Z.js";function Z(){const e=k("vaSketch");if(!e)throw new Error("The component which use useSketch() must be in a Sketch component");return e}const y={modelValue:{type:[Array,Object],default:()=>[]},multiple:{type:Boolean,default:!0}},q=V(y),p={"update:modelValue":e=>e,complete:e=>e,update:e=>!0,create:e=>!0},z=P(p),D={...y,defaultOptions:{type:Object,default:()=>({})},availableCreatureTools:{type:Array,default:void 0},position:{type:String,default:"top-right"},orphan:{type:Boolean,default:!1},modelValueInitFrom:{type:String,default:"modelValue"},viewModelPointSymbol:{type:Object},viewModelPolygonSymbol:{type:Object},viewModelPolylineSymbol:{type:Object},viewModelActiveFillSymbol:{type:Object},visibleElements:{type:Object,default:void 0}},K=q,J={load:e=>e,...p},Q=z,R=E({props:y,emits:p,setup(e,{emit:l}){const s=Z(),n=N(),a=s.on("create",o=>{l("create",o),o.state==="start"?e.multiple||n.removeAll():o.state==="complete"&&(!e.multiple&&n.graphics.length>1&&o.graphic.geometry.type==="point"&&n.remove(n.graphics.getItemAt(0)),l("update:modelValue",[...n.graphics]),l("complete",o))});u(()=>{a.remove()});const r=s.on("update",o=>{l("update",o),o.state==="complete"&&(l("update:modelValue",[...n.graphics]),l("complete",o))});return u(()=>{r.remove()}),()=>null}}),W=E({name:"VaSketch",components:{Events:R},emits:J,props:D,setup(e,{emit:l}){const s=L(),n=s.map;let a=k("vaGraphicsLayer",null);a||(a=new O,n.add(a));const r=K(e),o=Q(l);function v(t){a.removeAll(),a.addMany(t)}_(()=>e.modelValue,(t,b)=>{let d=!1;if(t.length===b.length){for(let c=0;c<t.length;c++)if(t[c]!==b[c]){d=!0;break}}else d=!0;d&&v([...t])}),e.modelValueInitFrom==="layerGraphics"?l("update:modelValue",a.graphics):v(e.modelValue);const f=g(),h=g(!1);return j(()=>{const t=new A({container:f.value,view:s,layer:a,creationMode:"single",...e.defaultOptions});i(()=>{e.visibleElements&&(t.visibleElements=e.visibleElements)}),i(()=>{e.viewModelPointSymbol&&(t.viewModel.pointSymbol=e.viewModelPointSymbol)}),i(()=>{e.viewModelPolylineSymbol&&(t.viewModel.polylineSymbol=e.viewModelPolylineSymbol)}),i(()=>{e.viewModelPolygonSymbol&&(t.viewModel.polygonSymbol=e.viewModelPolygonSymbol)}),i(()=>{e.viewModelActiveFillSymbol&&(t.viewModel.activeFillSymbol=e.viewModelActiveFillSymbol)}),i(()=>{e.availableCreatureTools&&(t.availableCreateTools=e.availableCreatureTools)}),u(()=>{t.destroy()}),U(s.ui,t,e),S("vaGraphicsLayer",a),S("vaSketch",t),h.value=!0,l("load",{sketch:t,view:s})}),{eventsBindProps:r,eventsOnEmits:o,sketchNode:f,ready:h}}}),X={ref:"sketchNode"};function Y(e,l,s,n,a,r){const o=C("Events");return w(),M("div",X,[e.ready?(w(),M(F,{key:0},[$(o,G(e.eventsBindProps,T(e.eventsOnEmits)),null,16),H(e.$slots,"default")],64)):I("",!0)],512)}const m=B(W,[["render",Y]]);m.install=e=>{e.component(m.name,m)};export{m as V};
