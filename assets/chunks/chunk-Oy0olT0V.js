import{mM as v,gs as E,c8 as $,gn as u,gt as V,nK as j,l1 as h,l6 as I,gF as O,gv as S,gG as k,gA as w,nH as C,gC as H,gL as A}from"./chunk-ERvgPDZ8.js";import{p as M,e as T,u as q,a as B}from"./chunk-QJB8kuK7.js";import{u as R}from"./chunk-OMr8FG4E.js";import{a as x}from"./chunk-yl6pYqlf.js";import{_ as U,c as D}from"./chunk-SpuRo9zE.js";import{m as G}from"./chunk-rnOeZc8c.js";import{c as F}from"./chunk-3E9jM2aR.js";const K={...M,source:{type:[Object,Array],required:!0,default:()=>[]},fields:{type:Array,required:!0,default:()=>[]},geometryType:{type:String,default:"point",required:!0},objectIdField:{type:String,default:"ObjectID"},forceUpdate:{type:Boolean,default:!1}},b={...T,change:e=>e,load:e=>e},ee=v(b),N=E({name:"VaClientFeatureLayer",components:{VaLayerHitEvents:U},emits:b,props:K,setup(e,{emit:i}){const n=R(),m=n.map,f=D(i),t=new $({source:e.source,...e.defaultOptions});t[F]=G();const d=t[F];return q(t,e),B(n,t,e),u(()=>{t.geometryType=e.geometryType}),u(()=>{t.objectIdField=e.objectIdField}),u(()=>{t.fields=e.fields}),x(m,t,e),V(()=>e.source,(L,_)=>{j().then(()=>{const s=[],c=L.reduce((a,r)=>{const o=r.attributes[e.objectIdField];return a[o]=r,a},{}),p=_.reduce((a,r)=>{const o=r.attributes[e.objectIdField];return Reflect.has(c,o)?(s.push(r),Reflect.deleteProperty(c,o)):a[o]=r,a},{}),y=[],g=[];for(const a in c)y.push(c[a]);for(const a in p)g.push(p[a]);return{addFeatures:y,deleteFeatures:g,updateFeatures:s}}).then(s=>t.applyEdits(s)).then(()=>(e.forceUpdate&&(t.visible=!1,t.visible=!0),{view:n,layer:t})).then(s=>{d.emit("change",s),i("change",s)})}),h("vaLayer",t),h("vaFeatureLayer",t),i("load",{view:n,layer:t}),{hitEmits:f}}});function P(e,i,n,m,f,t){const d=O("VaLayerHitEvents");return S(),k(A,null,[w(d,C(e.hitEmits),null,16),H(e.$slots,"default")],64)}const l=I(N,[["render",P]]);l.install=e=>{e.component(l.name,l)};export{l as V,ee as c,b as e};
